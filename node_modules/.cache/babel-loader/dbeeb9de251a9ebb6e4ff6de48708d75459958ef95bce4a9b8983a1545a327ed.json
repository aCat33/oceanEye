{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\10211\\\\Desktop\\\\AI Files\\\\oceanEye\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useMemo } from 'react';\nimport './App.css';\nimport TopNavigation from './components/TopNavigation';\nimport DrawingToolbar from './components/DrawingToolbar';\nimport PlaybackControls from './components/PlaybackControls';\nimport SidebarPanel from './components/SidebarPanel';\nimport RouteDataPreview from './components/RouteDataPreview';\nimport { Loader2 } from './components/Icons';\nimport { generateData, generateWeatherData, TYPHOON_DATA } from './utils/dataGenerator';\nimport { renderMarkersForTianditu } from './utils/markerUtils';\nimport { useMapInitialization, useTileLayerSwitch, useWeatherLayer, useTyphoonLayer } from './utils/mapHooks';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function App() {\n  _s();\n  const mapContainerRef = useRef(null);\n  const mapInstanceRef = useRef(null);\n  const tileLayerRef = useRef(null);\n  const markersLayerRef = useRef(null);\n  const routeLayerRef = useRef(null);\n  const playbackLayerRef = useRef(null);\n  const importLayerRef = useRef(null);\n  const drawingLayerRef = useRef(null);\n  const typhoonLayerRef = useRef(null);\n  const weatherLayerRef = useRef(null);\n  const fileInputRef = useRef(null);\n  const scriptLoadedRef = useRef(false);\n  const [allItems, setAllItems] = useState([]);\n  const [weatherData, setWeatherData] = useState([]);\n  const [selectedCluster, setSelectedCluster] = useState(null);\n  const [highlightedItemId, setHighlightedItemId] = useState(null);\n  const [libLoaded, setLibLoaded] = useState(false);\n  const [mapReady, setMapReady] = useState(false);\n  const [showWeather, setShowWeather] = useState(false);\n  const [isOfflineMode, setIsOfflineMode] = useState(false);\n  const [playbackState, setPlaybackState] = useState({\n    id: null,\n    index: 0,\n    playing: false\n  });\n  const [previewDataId, setPreviewDataId] = useState(null);\n  const [isDrawingMode, setIsDrawingMode] = useState(false);\n  const [drawnRoutePoints, setDrawnRoutePoints] = useState([]);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [isSearchFocused, setIsSearchFocused] = useState(false);\n  const activeAlarms = useMemo(() => allItems.filter(i => i.isAlarm), [allItems]);\n  const filteredItems = useMemo(() => {\n    if (!searchQuery) return [];\n    const lower = searchQuery.toLowerCase();\n    return allItems.filter(item => item.name.toLowerCase().includes(lower) || item.id.toLowerCase().includes(lower)).slice(0, 10);\n  }, [searchQuery, allItems]);\n\n  // 加载天地图库\n  useEffect(() => {\n    if (scriptLoadedRef.current) return;\n    const checkTianditu = () => window.T && typeof window.T.Map === 'function';\n    if (checkTianditu()) {\n      setLibLoaded(true);\n      return;\n    }\n    scriptLoadedRef.current = true;\n\n    // 天地图脚本已在 public/index.html 中加载，这里只需要等待加载完成\n    const interval = setInterval(() => {\n      if (checkTianditu()) {\n        setLibLoaded(true);\n        clearInterval(interval);\n      }\n    }, 100);\n    setTimeout(() => {\n      clearInterval(interval);\n      if (!checkTianditu()) {\n        console.error(\"天地图 API 加载失败\");\n      }\n    }, 10000);\n    return () => clearInterval(interval);\n  }, []);\n  useEffect(() => {\n    setAllItems(generateData());\n    setWeatherData(generateWeatherData());\n  }, []);\n  useMapInitialization(libLoaded, mapContainerRef, mapInstanceRef, tileLayerRef, weatherLayerRef, routeLayerRef, markersLayerRef, typhoonLayerRef, playbackLayerRef, importLayerRef, drawingLayerRef, setMapReady);\n  useTileLayerSwitch(mapInstanceRef, tileLayerRef, isOfflineMode, libLoaded);\n  useWeatherLayer(mapInstanceRef, weatherLayerRef, weatherData, showWeather, libLoaded);\n  useTyphoonLayer(mapInstanceRef, typhoonLayerRef, mapReady, libLoaded);\n\n  // 绘图模式逻辑\n  useEffect(() => {\n    if (!mapInstanceRef.current || !window.T) return;\n    const map = mapInstanceRef.current;\n    const handleMapClick = e => {\n      if (!isDrawingMode) return;\n      setDrawnRoutePoints(prev => [...prev, [e.lnglat.lat, e.lnglat.lng]]);\n    };\n    if (isDrawingMode) {\n      map.addEventListener('click', handleMapClick);\n    } else {\n      map.removeEventListener('click', handleMapClick);\n    }\n    return () => {\n      if (map) map.removeEventListener('click', handleMapClick);\n    };\n  }, [isDrawingMode, libLoaded]);\n\n  // 绘图图层渲染\n  useEffect(() => {\n    if (!drawingLayerRef.current || !window.T) return;\n    const T = window.T;\n    const map = mapInstanceRef.current;\n    const layer = drawingLayerRef.current;\n\n    // 清除旧图层\n    layer.forEach(overlay => map.removeOverLay(overlay));\n    layer.length = 0;\n    if (drawnRoutePoints.length > 0) {\n      const points = drawnRoutePoints.map(p => new T.LngLat(p[1], p[0]));\n      const line = new T.Polyline(points, {\n        color: '#fbbf24',\n        weight: 3,\n        opacity: 0.8,\n        style: 'dashed'\n      });\n      map.addOverLay(line);\n      layer.push(line);\n      drawnRoutePoints.forEach((p, i) => {\n        const circleIcon = new T.Icon({\n          iconUrl: \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"10\" height=\"10\"><circle cx=\"5\" cy=\"5\" r=\"5\" fill=\"#fbbf24\"/></svg>`),\n          iconSize: new T.Point(10, 10),\n          iconAnchor: new T.Point(5, 5)\n        });\n        const marker = new T.Marker(new T.LngLat(p[1], p[0]), {\n          icon: circleIcon\n        });\n        const label = new T.Label({\n          text: `WP ${i + 1}`,\n          position: new T.LngLat(p[1], p[0]),\n          offset: new T.Point(0, -10)\n        });\n        marker.addLabel(label);\n        map.addOverLay(marker);\n        layer.push(marker);\n      });\n    }\n  }, [drawnRoutePoints, libLoaded]);\n\n  // 回放控制\n  useEffect(() => {\n    let timer;\n    if (playbackState.playing && playbackState.id) {\n      timer = setInterval(() => {\n        setPlaybackState(prev => {\n          const ship = allItems.find(s => s.id === prev.id);\n          if (!ship || !ship.historyPath || prev.index >= ship.historyPath.length - 1) {\n            return {\n              ...prev,\n              playing: false\n            };\n          }\n          return {\n            ...prev,\n            index: prev.index + 1\n          };\n        });\n      }, 150);\n    }\n    return () => clearInterval(timer);\n  }, [playbackState.playing, playbackState.id, allItems]);\n\n  // 回放图层\n  useEffect(() => {\n    if (!mapInstanceRef.current || !playbackLayerRef.current || !libLoaded || !window.T) return;\n    const T = window.T;\n    const map = mapInstanceRef.current;\n    const layer = playbackLayerRef.current;\n\n    // 清除旧图层\n    layer.forEach(overlay => map.removeOverLay(overlay));\n    layer.length = 0;\n    if (playbackState.id) {\n      const ship = allItems.find(s => s.id === playbackState.id);\n      if (ship && ship.historyPath && ship.historyPath.length > 0) {\n        // 完整轨迹线\n        const fullPath = ship.historyPath.map(p => new T.LngLat(p[1], p[0]));\n        const fullLine = new T.Polyline(fullPath, {\n          color: '#64748b',\n          weight: 2,\n          opacity: 0.5,\n          style: 'dashed'\n        });\n        map.addOverLay(fullLine);\n        layer.push(fullLine);\n\n        // 已走过的轨迹\n        const travelledPath = ship.historyPath.slice(0, playbackState.index + 1).map(p => new T.LngLat(p[1], p[0]));\n        const travelledLine = new T.Polyline(travelledPath, {\n          color: '#0ea5e9',\n          weight: 3,\n          opacity: 1\n        });\n        map.addOverLay(travelledLine);\n        layer.push(travelledLine);\n\n        // 当前位置\n        const currentPos = ship.historyPath[playbackState.index];\n        if (currentPos) {\n          const iconHtml = `<div class=\"relative w-8 h-8 flex items-center justify-center bg-blue-600 rounded-full border-2 border-white shadow-lg text-white\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" style=\"transform: rotate(${ship.course}deg)\"><path d=\"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1 .6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1\" /><path d=\"M19.38 20A11.6 11.6 0 0 0 21 14l-9-4-9 4c0 2.9.9 5.8 2.5 8\" /></svg></div>`;\n          const icon = new T.Icon({\n            iconUrl: \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\"><foreignObject width=\"32\" height=\"32\">${iconHtml}</foreignObject></svg>`),\n            iconSize: new T.Point(32, 32),\n            iconAnchor: new T.Point(16, 16)\n          });\n          const marker = new T.Marker(new T.LngLat(currentPos[1], currentPos[0]), {\n            icon\n          });\n          map.addOverLay(marker);\n          layer.push(marker);\n          if (playbackState.playing) {\n            map.panTo(new T.LngLat(currentPos[1], currentPos[0]));\n          }\n        }\n      }\n    }\n  }, [playbackState, allItems, libLoaded]);\n\n  // 选中航线图层\n  useEffect(() => {\n    if (!mapInstanceRef.current || !routeLayerRef.current || !libLoaded || !window.T) return;\n    const T = window.T;\n    const map = mapInstanceRef.current;\n    const layer = routeLayerRef.current;\n\n    // 清除旧图层\n    layer.forEach(overlay => map.removeOverLay(overlay));\n    layer.length = 0;\n    if (!highlightedItemId) return;\n    const item = allItems.find(i => i.id === highlightedItemId);\n    if (item && item.type === 'ship' && item.plannedRoute) {\n      const routePoints = item.plannedRoute.map(p => new T.LngLat(p[1], p[0]));\n      const routeLine = new T.Polyline(routePoints, {\n        color: '#3b82f6',\n        weight: 2,\n        opacity: 0.8,\n        style: 'dashed'\n      });\n      map.addOverLay(routeLine);\n      layer.push(routeLine);\n      if (item.isAlarm) {\n        const currentPos = new T.LngLat(item.lon, item.lat);\n        const nearestRoutePoint = new T.LngLat(item.plannedRoute[0][1], item.plannedRoute[0][0]);\n        const deviationLine = new T.Polyline([currentPos, nearestRoutePoint], {\n          color: '#ef4444',\n          weight: 2,\n          opacity: 0.8\n        });\n        map.addOverLay(deviationLine);\n        layer.push(deviationLine);\n        const midLat = (item.lat + item.plannedRoute[0][0]) / 2;\n        const midLon = (item.lon + item.plannedRoute[0][1]) / 2;\n        const labelIcon = new T.Icon({\n          iconUrl: \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"80\" height=\"20\"><foreignObject width=\"80\" height=\"20\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"bg-red-600 text-white text-[10px] px-1 rounded shadow whitespace-nowrap\">偏离 ${item.xte.toFixed(1)} NM</div></foreignObject></svg>`),\n          iconSize: new T.Point(80, 20),\n          iconAnchor: new T.Point(40, 10)\n        });\n        const labelMarker = new T.Marker(new T.LngLat(midLon, midLat), {\n          icon: labelIcon\n        });\n        map.addOverLay(labelMarker);\n        layer.push(labelMarker);\n      }\n    }\n  }, [highlightedItemId, allItems, libLoaded]);\n\n  // 标记图层\n  useEffect(() => {\n    if (!mapInstanceRef.current || !markersLayerRef.current || allItems.length === 0 || !libLoaded || !window.T) return;\n    const T = window.T;\n    const map = mapInstanceRef.current;\n    const layer = markersLayerRef.current;\n    renderMarkersForTianditu(map, T, layer, allItems, highlightedItemId, playbackState, setHighlightedItemId, setSelectedCluster);\n  }, [allItems, mapReady, libLoaded, highlightedItemId, playbackState]);\n  const handleLocateItem = item => {\n    setHighlightedItemId(item.id);\n    if (mapInstanceRef.current) mapInstanceRef.current.setView([item.lat, item.lon], 12, {\n      animate: true\n    });\n  };\n  const startPlayback = id => setPlaybackState({\n    id,\n    index: 0,\n    playing: true\n  });\n  const stopPlayback = () => setPlaybackState({\n    id: null,\n    index: 0,\n    playing: false\n  });\n  const togglePlayPause = () => setPlaybackState(prev => ({\n    ...prev,\n    playing: !prev.playing\n  }));\n  const handleStartDrawing = () => setIsDrawingMode(!isDrawingMode);\n  const handleClearDrawing = () => setDrawnRoutePoints([]);\n  const handleUndoDrawing = () => setDrawnRoutePoints(prev => prev.slice(0, -1));\n  const handleSaveDrawing = () => {\n    if (drawnRoutePoints.length < 2) {\n      alert(\"请至少绘制两个航路点\");\n      return;\n    }\n    const geoJson = {\n      type: \"Feature\",\n      properties: {\n        name: `Custom Route ${new Date().toLocaleString()}`\n      },\n      geometry: {\n        type: \"LineString\",\n        coordinates: drawnRoutePoints.map(p => [p[1], p[0]])\n      }\n    };\n    const blob = new Blob([JSON.stringify(geoJson, null, 2)], {\n      type: \"application/json\"\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `route_${Date.now()}.json`;\n    a.click();\n    URL.revokeObjectURL(url);\n    alert(`航线已保存 (${drawnRoutePoints.length} WPs)`);\n    setIsDrawingMode(false);\n  };\n  const handleImportClick = () => {\n    var _fileInputRef$current;\n    return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n  };\n  const drawImportedRoute = points => {\n    if (!mapInstanceRef.current || !importLayerRef.current || !window.L) return;\n    const L = window.L;\n    importLayerRef.current.clearLayers();\n    L.polyline(points, {\n      color: '#d946ef',\n      weight: 4,\n      dashArray: '10, 5'\n    }).addTo(importLayerRef.current);\n    points.forEach((p, i) => {\n      L.circleMarker(p, {\n        radius: 4,\n        color: '#d946ef',\n        fillColor: '#fff',\n        fillOpacity: 1\n      }).addTo(importLayerRef.current).bindPopup(`WP ${i + 1}: ${p[0].toFixed(4)}, ${p[1].toFixed(4)}`);\n    });\n    mapInstanceRef.current.fitBounds(L.polyline(points).getBounds(), {\n      padding: [50, 50]\n    });\n  };\n  const handleFileImport = event => {\n    const file = event.target.files[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = e => {\n      const text = e.target.result;\n      try {\n        let routePoints = [];\n        if (text.trim().startsWith('{') || text.trim().startsWith('[')) {\n          const json = JSON.parse(text);\n          if (Array.isArray(json)) {\n            routePoints = json.map(p => Array.isArray(p) ? p : [p.lat || p.latitude, p.lon || p.lng || p.longitude]);\n          } else if (json.type === 'FeatureCollection' || json.type === 'Feature') {\n            const features = json.type === 'FeatureCollection' ? json.features : [json];\n            const lineString = features.find(f => f.geometry.type === 'LineString');\n            if (lineString) routePoints = lineString.geometry.coordinates.map(c => [c[1], c[0]]);\n          }\n        } else {\n          text.split('\\n').forEach(line => {\n            const cleanLine = line.replace(/['\"]/g, '').trim();\n            if (!cleanLine) return;\n            const parts = cleanLine.split(/[,\\t;]/).map(s => s.trim());\n            const coords = parts.filter(p => !isNaN(parseFloat(p)) && Math.abs(parseFloat(p)) <= 180);\n            if (coords.length >= 2) {\n              const v1 = parseFloat(coords[0]);\n              const v2 = parseFloat(coords[1]);\n              if (v1 >= -90 && v1 <= 90 && v2 >= -180 && v2 <= 180) routePoints.push([v1, v2]);\n            }\n          });\n        }\n        if (routePoints.length > 1) {\n          drawImportedRoute(routePoints);\n          setTimeout(() => alert(`成功导入航线，包含 ${routePoints.length} 个航路点。\\n已自动缩放至航线区域。`), 100);\n        } else {\n          alert(\"未识别到有效的航路点数据。\\n\\n支持格式:\\n1. CSV: lat,lon\\n2. GeoJSON\\n3. JSON 数组\");\n        }\n      } catch (err) {\n        console.error(\"Import failed\", err);\n        alert(\"导入失败：文件格式解析错误\");\n      }\n    };\n    reader.readAsText(file);\n    event.target.value = '';\n  };\n  const handleRefresh = () => {\n    setAllItems(generateData());\n    setWeatherData(generateWeatherData());\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col h-screen w-full bg-slate-900 text-white font-sans overflow-hidden\",\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      ref: fileInputRef,\n      style: {\n        display: 'none'\n      },\n      accept: \".csv,.json,.txt,.geojson\",\n      onChange: handleFileImport\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 369,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TopNavigation, {\n      activeAlarms: activeAlarms,\n      isOfflineMode: isOfflineMode,\n      setIsOfflineMode: setIsOfflineMode,\n      isDrawingMode: isDrawingMode,\n      handleStartDrawing: handleStartDrawing,\n      handleImportClick: handleImportClick,\n      showWeather: showWeather,\n      setShowWeather: setShowWeather,\n      typhoonData: TYPHOON_DATA,\n      mapInstance: mapInstanceRef.current,\n      handleRefresh: handleRefresh,\n      searchQuery: searchQuery,\n      setSearchQuery: setSearchQuery,\n      isSearchFocused: isSearchFocused,\n      setIsSearchFocused: setIsSearchFocused,\n      filteredItems: filteredItems,\n      handleLocateItem: handleLocateItem\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 relative w-full h-full bg-slate-900\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"map\",\n        ref: mapContainerRef,\n        className: \"w-full h-full z-0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 9\n      }, this), !libLoaded && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"absolute inset-0 flex items-center justify-center bg-slate-900 z-50 text-slate-400\",\n        children: [/*#__PURE__*/_jsxDEV(Loader2, {\n          className: \"animate-spin\",\n          size: 32\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u52A0\\u8F7D\\u4E2D...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 11\n      }, this), isDrawingMode && /*#__PURE__*/_jsxDEV(DrawingToolbar, {\n        handleUndoDrawing: handleUndoDrawing,\n        handleClearDrawing: handleClearDrawing,\n        handleSaveDrawing: handleSaveDrawing,\n        handleStartDrawing: handleStartDrawing\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 11\n      }, this), previewDataId && /*#__PURE__*/_jsxDEV(RouteDataPreview, {\n        ship: allItems.find(i => i.id === previewDataId),\n        onClose: () => setPreviewDataId(null)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(PlaybackControls, {\n        playbackState: playbackState,\n        togglePlayPause: togglePlayPause,\n        stopPlayback: stopPlayback\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SidebarPanel, {\n        selectedCluster: selectedCluster,\n        setSelectedCluster: setSelectedCluster,\n        handleLocateItem: handleLocateItem,\n        highlightedItemId: highlightedItemId,\n        startPlayback: startPlayback,\n        setPreviewDataId: setPreviewDataId\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 391,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 368,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"DsyvDfV3DoyttOHhGd9lEArdc1I=\", false, function () {\n  return [useMapInitialization, useTileLayerSwitch, useWeatherLayer, useTyphoonLayer];\n});\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useMemo","TopNavigation","DrawingToolbar","PlaybackControls","SidebarPanel","RouteDataPreview","Loader2","generateData","generateWeatherData","TYPHOON_DATA","renderMarkersForTianditu","useMapInitialization","useTileLayerSwitch","useWeatherLayer","useTyphoonLayer","jsxDEV","_jsxDEV","App","_s","mapContainerRef","mapInstanceRef","tileLayerRef","markersLayerRef","routeLayerRef","playbackLayerRef","importLayerRef","drawingLayerRef","typhoonLayerRef","weatherLayerRef","fileInputRef","scriptLoadedRef","allItems","setAllItems","weatherData","setWeatherData","selectedCluster","setSelectedCluster","highlightedItemId","setHighlightedItemId","libLoaded","setLibLoaded","mapReady","setMapReady","showWeather","setShowWeather","isOfflineMode","setIsOfflineMode","playbackState","setPlaybackState","id","index","playing","previewDataId","setPreviewDataId","isDrawingMode","setIsDrawingMode","drawnRoutePoints","setDrawnRoutePoints","searchQuery","setSearchQuery","isSearchFocused","setIsSearchFocused","activeAlarms","filter","i","isAlarm","filteredItems","lower","toLowerCase","item","name","includes","slice","current","checkTianditu","window","T","Map","interval","setInterval","clearInterval","setTimeout","console","error","map","handleMapClick","e","prev","lnglat","lat","lng","addEventListener","removeEventListener","layer","forEach","overlay","removeOverLay","length","points","p","LngLat","line","Polyline","color","weight","opacity","style","addOverLay","push","circleIcon","Icon","iconUrl","encodeURIComponent","iconSize","Point","iconAnchor","marker","Marker","icon","label","Label","text","position","offset","addLabel","timer","ship","find","s","historyPath","fullPath","fullLine","travelledPath","travelledLine","currentPos","iconHtml","course","panTo","type","plannedRoute","routePoints","routeLine","lon","nearestRoutePoint","deviationLine","midLat","midLon","labelIcon","xte","toFixed","labelMarker","handleLocateItem","setView","animate","startPlayback","stopPlayback","togglePlayPause","handleStartDrawing","handleClearDrawing","handleUndoDrawing","handleSaveDrawing","alert","geoJson","properties","Date","toLocaleString","geometry","coordinates","blob","Blob","JSON","stringify","url","URL","createObjectURL","a","document","createElement","href","download","now","click","revokeObjectURL","handleImportClick","_fileInputRef$current","drawImportedRoute","L","clearLayers","polyline","dashArray","addTo","circleMarker","radius","fillColor","fillOpacity","bindPopup","fitBounds","getBounds","padding","handleFileImport","event","file","target","files","reader","FileReader","onload","result","trim","startsWith","json","parse","Array","isArray","latitude","longitude","features","lineString","f","c","split","cleanLine","replace","parts","coords","isNaN","parseFloat","Math","abs","v1","v2","err","readAsText","value","handleRefresh","className","children","ref","display","accept","onChange","fileName","_jsxFileName","lineNumber","columnNumber","typhoonData","mapInstance","size","onClose","_c","$RefreshReg$"],"sources":["C:/Users/10211/Desktop/AI Files/oceanEye/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useMemo } from 'react';\r\nimport './App.css';\r\nimport TopNavigation from './components/TopNavigation';\r\nimport DrawingToolbar from './components/DrawingToolbar';\r\nimport PlaybackControls from './components/PlaybackControls';\r\nimport SidebarPanel from './components/SidebarPanel';\r\nimport RouteDataPreview from './components/RouteDataPreview';\r\nimport { Loader2 } from './components/Icons';\r\nimport { generateData, generateWeatherData, TYPHOON_DATA } from './utils/dataGenerator';\r\nimport { renderMarkersForTianditu } from './utils/markerUtils';\r\nimport { \r\n  useMapInitialization, \r\n  useTileLayerSwitch, \r\n  useWeatherLayer, \r\n  useTyphoonLayer \r\n} from './utils/mapHooks';\r\n\r\nexport default function App() {\r\n  const mapContainerRef = useRef(null);\r\n  const mapInstanceRef = useRef(null);\r\n  const tileLayerRef = useRef(null);\r\n  const markersLayerRef = useRef(null);\r\n  const routeLayerRef = useRef(null);\r\n  const playbackLayerRef = useRef(null);\r\n  const importLayerRef = useRef(null);\r\n  const drawingLayerRef = useRef(null);\r\n  const typhoonLayerRef = useRef(null);\r\n  const weatherLayerRef = useRef(null);\r\n  const fileInputRef = useRef(null);\r\n  const scriptLoadedRef = useRef(false);\r\n\r\n  const [allItems, setAllItems] = useState([]);\r\n  const [weatherData, setWeatherData] = useState([]);\r\n  const [selectedCluster, setSelectedCluster] = useState(null);\r\n  const [highlightedItemId, setHighlightedItemId] = useState(null); \r\n  const [libLoaded, setLibLoaded] = useState(false);\r\n  const [mapReady, setMapReady] = useState(false);\r\n  const [showWeather, setShowWeather] = useState(false);\r\n  const [isOfflineMode, setIsOfflineMode] = useState(false);\r\n  const [playbackState, setPlaybackState] = useState({ id: null, index: 0, playing: false });\r\n  const [previewDataId, setPreviewDataId] = useState(null);\r\n  const [isDrawingMode, setIsDrawingMode] = useState(false);\r\n  const [drawnRoutePoints, setDrawnRoutePoints] = useState([]);\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [isSearchFocused, setIsSearchFocused] = useState(false);\r\n\r\n  const activeAlarms = useMemo(() => allItems.filter(i => i.isAlarm), [allItems]);\r\n  const filteredItems = useMemo(() => {\r\n    if (!searchQuery) return [];\r\n    const lower = searchQuery.toLowerCase();\r\n    return allItems.filter(item => \r\n      item.name.toLowerCase().includes(lower) || \r\n      item.id.toLowerCase().includes(lower)\r\n    ).slice(0, 10);\r\n  }, [searchQuery, allItems]);\r\n\r\n  // 加载天地图库\r\n  useEffect(() => {\r\n    if (scriptLoadedRef.current) return;\r\n    const checkTianditu = () => window.T && typeof window.T.Map === 'function';\r\n    if (checkTianditu()) { setLibLoaded(true); return; }\r\n    scriptLoadedRef.current = true;\r\n    \r\n    // 天地图脚本已在 public/index.html 中加载，这里只需要等待加载完成\r\n    const interval = setInterval(() => {\r\n      if (checkTianditu()) { \r\n        setLibLoaded(true); \r\n        clearInterval(interval); \r\n      }\r\n    }, 100);\r\n    \r\n    setTimeout(() => {\r\n      clearInterval(interval);\r\n      if (!checkTianditu()) {\r\n        console.error(\"天地图 API 加载失败\");\r\n      }\r\n    }, 10000);\r\n    \r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  useEffect(() => { setAllItems(generateData()); setWeatherData(generateWeatherData()); }, []);\r\n\r\n  useMapInitialization(libLoaded, mapContainerRef, mapInstanceRef, tileLayerRef, weatherLayerRef, routeLayerRef, markersLayerRef, typhoonLayerRef, playbackLayerRef, importLayerRef, drawingLayerRef, setMapReady);\r\n  useTileLayerSwitch(mapInstanceRef, tileLayerRef, isOfflineMode, libLoaded);\r\n  useWeatherLayer(mapInstanceRef, weatherLayerRef, weatherData, showWeather, libLoaded);\r\n  useTyphoonLayer(mapInstanceRef, typhoonLayerRef, mapReady, libLoaded);\r\n\r\n  // 绘图模式逻辑\r\n  useEffect(() => {\r\n    if (!mapInstanceRef.current || !window.T) return;\r\n    const map = mapInstanceRef.current;\r\n    const handleMapClick = (e) => {\r\n      if (!isDrawingMode) return;\r\n      setDrawnRoutePoints(prev => [...prev, [e.lnglat.lat, e.lnglat.lng]]);\r\n    };\r\n    if (isDrawingMode) {\r\n      map.addEventListener('click', handleMapClick);\r\n    } else {\r\n      map.removeEventListener('click', handleMapClick);\r\n    }\r\n    return () => { \r\n      if (map) map.removeEventListener('click', handleMapClick); \r\n    };\r\n  }, [isDrawingMode, libLoaded]);\r\n\r\n  // 绘图图层渲染\r\n  useEffect(() => {\r\n    if (!drawingLayerRef.current || !window.T) return;\r\n    const T = window.T;\r\n    const map = mapInstanceRef.current;\r\n    const layer = drawingLayerRef.current;\r\n    \r\n    // 清除旧图层\r\n    layer.forEach(overlay => map.removeOverLay(overlay));\r\n    layer.length = 0;\r\n    \r\n    if (drawnRoutePoints.length > 0) {\r\n      const points = drawnRoutePoints.map(p => new T.LngLat(p[1], p[0]));\r\n      const line = new T.Polyline(points, { \r\n        color: '#fbbf24', \r\n        weight: 3, \r\n        opacity: 0.8,\r\n        style: 'dashed'\r\n      });\r\n      map.addOverLay(line);\r\n      layer.push(line);\r\n      \r\n      drawnRoutePoints.forEach((p, i) => {\r\n        const circleIcon = new T.Icon({\r\n          iconUrl: \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"10\" height=\"10\"><circle cx=\"5\" cy=\"5\" r=\"5\" fill=\"#fbbf24\"/></svg>`),\r\n          iconSize: new T.Point(10, 10),\r\n          iconAnchor: new T.Point(5, 5)\r\n        });\r\n        const marker = new T.Marker(new T.LngLat(p[1], p[0]), { icon: circleIcon });\r\n        const label = new T.Label({ text: `WP ${i+1}`, position: new T.LngLat(p[1], p[0]), offset: new T.Point(0, -10) });\r\n        marker.addLabel(label);\r\n        map.addOverLay(marker);\r\n        layer.push(marker);\r\n      });\r\n    }\r\n  }, [drawnRoutePoints, libLoaded]);\r\n\r\n  // 回放控制\r\n  useEffect(() => {\r\n    let timer;\r\n    if (playbackState.playing && playbackState.id) {\r\n      timer = setInterval(() => {\r\n        setPlaybackState(prev => {\r\n          const ship = allItems.find(s => s.id === prev.id);\r\n          if (!ship || !ship.historyPath || prev.index >= ship.historyPath.length - 1) {\r\n            return { ...prev, playing: false };\r\n          }\r\n          return { ...prev, index: prev.index + 1 };\r\n        });\r\n      }, 150);\r\n    }\r\n    return () => clearInterval(timer);\r\n  }, [playbackState.playing, playbackState.id, allItems]);\r\n\r\n  // 回放图层\r\n  useEffect(() => {\r\n    if (!mapInstanceRef.current || !playbackLayerRef.current || !libLoaded || !window.T) return;\r\n    const T = window.T;\r\n    const map = mapInstanceRef.current;\r\n    const layer = playbackLayerRef.current;\r\n    \r\n    // 清除旧图层\r\n    layer.forEach(overlay => map.removeOverLay(overlay));\r\n    layer.length = 0;\r\n    \r\n    if (playbackState.id) {\r\n      const ship = allItems.find(s => s.id === playbackState.id);\r\n      if (ship && ship.historyPath && ship.historyPath.length > 0) {\r\n        // 完整轨迹线\r\n        const fullPath = ship.historyPath.map(p => new T.LngLat(p[1], p[0]));\r\n        const fullLine = new T.Polyline(fullPath, { \r\n          color: '#64748b', \r\n          weight: 2, \r\n          opacity: 0.5,\r\n          style: 'dashed'\r\n        });\r\n        map.addOverLay(fullLine);\r\n        layer.push(fullLine);\r\n        \r\n        // 已走过的轨迹\r\n        const travelledPath = ship.historyPath.slice(0, playbackState.index + 1).map(p => new T.LngLat(p[1], p[0]));\r\n        const travelledLine = new T.Polyline(travelledPath, { \r\n          color: '#0ea5e9', \r\n          weight: 3, \r\n          opacity: 1 \r\n        });\r\n        map.addOverLay(travelledLine);\r\n        layer.push(travelledLine);\r\n        \r\n        // 当前位置\r\n        const currentPos = ship.historyPath[playbackState.index];\r\n        if (currentPos) {\r\n          const iconHtml = `<div class=\"relative w-8 h-8 flex items-center justify-center bg-blue-600 rounded-full border-2 border-white shadow-lg text-white\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" style=\"transform: rotate(${ship.course}deg)\"><path d=\"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1 .6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1\" /><path d=\"M19.38 20A11.6 11.6 0 0 0 21 14l-9-4-9 4c0 2.9.9 5.8 2.5 8\" /></svg></div>`;\r\n          \r\n          const icon = new T.Icon({\r\n            iconUrl: \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\"><foreignObject width=\"32\" height=\"32\">${iconHtml}</foreignObject></svg>`),\r\n            iconSize: new T.Point(32, 32),\r\n            iconAnchor: new T.Point(16, 16)\r\n          });\r\n          \r\n          const marker = new T.Marker(new T.LngLat(currentPos[1], currentPos[0]), { icon });\r\n          map.addOverLay(marker);\r\n          layer.push(marker);\r\n          \r\n          if (playbackState.playing) {\r\n            map.panTo(new T.LngLat(currentPos[1], currentPos[0]));\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }, [playbackState, allItems, libLoaded]);\r\n\r\n  // 选中航线图层\r\n  useEffect(() => {\r\n    if (!mapInstanceRef.current || !routeLayerRef.current || !libLoaded || !window.T) return;\r\n    const T = window.T;\r\n    const map = mapInstanceRef.current;\r\n    const layer = routeLayerRef.current;\r\n    \r\n    // 清除旧图层\r\n    layer.forEach(overlay => map.removeOverLay(overlay));\r\n    layer.length = 0;\r\n    \r\n    if (!highlightedItemId) return;\r\n    const item = allItems.find(i => i.id === highlightedItemId);\r\n    if (item && item.type === 'ship' && item.plannedRoute) {\r\n      const routePoints = item.plannedRoute.map(p => new T.LngLat(p[1], p[0]));\r\n      const routeLine = new T.Polyline(routePoints, { \r\n        color: '#3b82f6', \r\n        weight: 2, \r\n        opacity: 0.8,\r\n        style: 'dashed'\r\n      });\r\n      map.addOverLay(routeLine);\r\n      layer.push(routeLine);\r\n      \r\n      if (item.isAlarm) {\r\n        const currentPos = new T.LngLat(item.lon, item.lat);\r\n        const nearestRoutePoint = new T.LngLat(item.plannedRoute[0][1], item.plannedRoute[0][0]);\r\n        const deviationLine = new T.Polyline([currentPos, nearestRoutePoint], { \r\n          color: '#ef4444', \r\n          weight: 2, \r\n          opacity: 0.8 \r\n        });\r\n        map.addOverLay(deviationLine);\r\n        layer.push(deviationLine);\r\n        \r\n        const midLat = (item.lat + item.plannedRoute[0][0])/2;\r\n        const midLon = (item.lon + item.plannedRoute[0][1])/2;\r\n        \r\n        const labelIcon = new T.Icon({\r\n          iconUrl: \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"80\" height=\"20\"><foreignObject width=\"80\" height=\"20\"><div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"bg-red-600 text-white text-[10px] px-1 rounded shadow whitespace-nowrap\">偏离 ${item.xte.toFixed(1)} NM</div></foreignObject></svg>`),\r\n          iconSize: new T.Point(80, 20),\r\n          iconAnchor: new T.Point(40, 10)\r\n        });\r\n        const labelMarker = new T.Marker(new T.LngLat(midLon, midLat), { icon: labelIcon });\r\n        map.addOverLay(labelMarker);\r\n        layer.push(labelMarker);\r\n      }\r\n    }\r\n  }, [highlightedItemId, allItems, libLoaded]);\r\n\r\n  // 标记图层\r\n  useEffect(() => {\r\n    if (!mapInstanceRef.current || !markersLayerRef.current || allItems.length === 0 || !libLoaded || !window.T) return;\r\n    const T = window.T;\r\n    const map = mapInstanceRef.current;\r\n    const layer = markersLayerRef.current;\r\n    \r\n    renderMarkersForTianditu(map, T, layer, allItems, highlightedItemId, playbackState, setHighlightedItemId, setSelectedCluster);\r\n  }, [allItems, mapReady, libLoaded, highlightedItemId, playbackState]);\r\n\r\n  const handleLocateItem = (item) => {\r\n    setHighlightedItemId(item.id);\r\n    if (mapInstanceRef.current) mapInstanceRef.current.setView([item.lat, item.lon], 12, { animate: true });\r\n  };\r\n\r\n  const startPlayback = (id) => setPlaybackState({ id, index: 0, playing: true });\r\n  const stopPlayback = () => setPlaybackState({ id: null, index: 0, playing: false });\r\n  const togglePlayPause = () => setPlaybackState(prev => ({ ...prev, playing: !prev.playing }));\r\n\r\n  const handleStartDrawing = () => setIsDrawingMode(!isDrawingMode);\r\n  const handleClearDrawing = () => setDrawnRoutePoints([]);\r\n  const handleUndoDrawing = () => setDrawnRoutePoints(prev => prev.slice(0, -1));\r\n  const handleSaveDrawing = () => {\r\n    if (drawnRoutePoints.length < 2) { alert(\"请至少绘制两个航路点\"); return; }\r\n    const geoJson = {\r\n      type: \"Feature\",\r\n      properties: { name: `Custom Route ${new Date().toLocaleString()}` },\r\n      geometry: { type: \"LineString\", coordinates: drawnRoutePoints.map(p => [p[1], p[0]]) }\r\n    };\r\n    const blob = new Blob([JSON.stringify(geoJson, null, 2)], {type: \"application/json\"});\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url; a.download = `route_${Date.now()}.json`; a.click();\r\n    URL.revokeObjectURL(url);\r\n    alert(`航线已保存 (${drawnRoutePoints.length} WPs)`);\r\n    setIsDrawingMode(false);\r\n  };\r\n\r\n  const handleImportClick = () => fileInputRef.current?.click();\r\n\r\n  const drawImportedRoute = (points) => {\r\n    if (!mapInstanceRef.current || !importLayerRef.current || !window.L) return;\r\n    const L = window.L;\r\n    importLayerRef.current.clearLayers();\r\n    L.polyline(points, { color: '#d946ef', weight: 4, dashArray: '10, 5' }).addTo(importLayerRef.current); \r\n    points.forEach((p, i) => {\r\n      L.circleMarker(p, { radius: 4, color: '#d946ef', fillColor: '#fff', fillOpacity: 1 })\r\n        .addTo(importLayerRef.current).bindPopup(`WP ${i+1}: ${p[0].toFixed(4)}, ${p[1].toFixed(4)}`);\r\n    });\r\n    mapInstanceRef.current.fitBounds(L.polyline(points).getBounds(), { padding: [50, 50] });\r\n  };\r\n\r\n  const handleFileImport = (event) => {\r\n    const file = event.target.files[0];\r\n    if (!file) return;\r\n    const reader = new FileReader();\r\n    reader.onload = (e) => {\r\n      const text = e.target.result;\r\n      try {\r\n        let routePoints = [];\r\n        if (text.trim().startsWith('{') || text.trim().startsWith('[')) {\r\n          const json = JSON.parse(text);\r\n          if (Array.isArray(json)) {\r\n            routePoints = json.map(p => Array.isArray(p) ? p : [p.lat || p.latitude, p.lon || p.lng || p.longitude]);\r\n          } else if (json.type === 'FeatureCollection' || json.type === 'Feature') {\r\n            const features = json.type === 'FeatureCollection' ? json.features : [json];\r\n            const lineString = features.find(f => f.geometry.type === 'LineString');\r\n            if (lineString) routePoints = lineString.geometry.coordinates.map(c => [c[1], c[0]]);\r\n          }\r\n        } else {\r\n          text.split('\\n').forEach(line => {\r\n            const cleanLine = line.replace(/['\"]/g, '').trim();\r\n            if (!cleanLine) return;\r\n            const parts = cleanLine.split(/[,\\t;]/).map(s => s.trim());\r\n            const coords = parts.filter(p => !isNaN(parseFloat(p)) && Math.abs(parseFloat(p)) <= 180);\r\n            if (coords.length >= 2) {\r\n              const v1 = parseFloat(coords[0]); const v2 = parseFloat(coords[1]);\r\n              if (v1 >= -90 && v1 <= 90 && v2 >= -180 && v2 <= 180) routePoints.push([v1, v2]);\r\n            }\r\n          });\r\n        }\r\n        if (routePoints.length > 1) {\r\n          drawImportedRoute(routePoints);\r\n          setTimeout(() => alert(`成功导入航线，包含 ${routePoints.length} 个航路点。\\n已自动缩放至航线区域。`), 100);\r\n        } else {\r\n          alert(\"未识别到有效的航路点数据。\\n\\n支持格式:\\n1. CSV: lat,lon\\n2. GeoJSON\\n3. JSON 数组\");\r\n        }\r\n      } catch (err) {\r\n        console.error(\"Import failed\", err);\r\n        alert(\"导入失败：文件格式解析错误\");\r\n      }\r\n    };\r\n    reader.readAsText(file);\r\n    event.target.value = '';\r\n  };\r\n\r\n  const handleRefresh = () => { setAllItems(generateData()); setWeatherData(generateWeatherData()); };\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-screen w-full bg-slate-900 text-white font-sans overflow-hidden\">\r\n      <input type=\"file\" ref={fileInputRef} style={{ display: 'none' }} accept=\".csv,.json,.txt,.geojson\" onChange={handleFileImport} />\r\n      \r\n      <TopNavigation \r\n        activeAlarms={activeAlarms}\r\n        isOfflineMode={isOfflineMode}\r\n        setIsOfflineMode={setIsOfflineMode}\r\n        isDrawingMode={isDrawingMode}\r\n        handleStartDrawing={handleStartDrawing}\r\n        handleImportClick={handleImportClick}\r\n        showWeather={showWeather}\r\n        setShowWeather={setShowWeather}\r\n        typhoonData={TYPHOON_DATA}\r\n        mapInstance={mapInstanceRef.current}\r\n        handleRefresh={handleRefresh}\r\n        searchQuery={searchQuery}\r\n        setSearchQuery={setSearchQuery}\r\n        isSearchFocused={isSearchFocused}\r\n        setIsSearchFocused={setIsSearchFocused}\r\n        filteredItems={filteredItems}\r\n        handleLocateItem={handleLocateItem}\r\n      />\r\n\r\n      <div className=\"flex-1 relative w-full h-full bg-slate-900\">\r\n        <div id=\"map\" ref={mapContainerRef} className=\"w-full h-full z-0\" />\r\n        \r\n        {!libLoaded && (\r\n          <div className=\"absolute inset-0 flex items-center justify-center bg-slate-900 z-50 text-slate-400\">\r\n            <Loader2 className=\"animate-spin\" size={32}/>\r\n            <span>加载中...</span>\r\n          </div>\r\n        )}\r\n\r\n        {isDrawingMode && (\r\n          <DrawingToolbar \r\n            handleUndoDrawing={handleUndoDrawing}\r\n            handleClearDrawing={handleClearDrawing}\r\n            handleSaveDrawing={handleSaveDrawing}\r\n            handleStartDrawing={handleStartDrawing}\r\n          />\r\n        )}\r\n\r\n        {previewDataId && (\r\n          <RouteDataPreview \r\n            ship={allItems.find(i => i.id === previewDataId)} \r\n            onClose={() => setPreviewDataId(null)} \r\n          />\r\n        )}\r\n\r\n        <PlaybackControls \r\n          playbackState={playbackState}\r\n          togglePlayPause={togglePlayPause}\r\n          stopPlayback={stopPlayback}\r\n        />\r\n\r\n        <SidebarPanel \r\n          selectedCluster={selectedCluster}\r\n          setSelectedCluster={setSelectedCluster}\r\n          handleLocateItem={handleLocateItem}\r\n          highlightedItemId={highlightedItemId}\r\n          startPlayback={startPlayback}\r\n          setPreviewDataId={setPreviewDataId}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}